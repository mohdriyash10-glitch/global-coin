<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Global Coin Wallet</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background: #0d1117; color: white; padding: 2rem; text-align: center; }
    input, button { padding: 10px; margin: 5px; border-radius: 8px; border: none; }
    button { background: #1f6feb; color: white; cursor: pointer; }
    .hidden { display: none; }
    .card { background: #161b22; border-radius: 12px; padding: 20px; margin: 10px auto; max-width: 400px; box-shadow: 0 0 10px rgba(0,0,0,0.5); }
  </style>
</head>
<body>
  <div class="card" id="login-screen">
    <h2>Login to Global Coin</h2>
    <input type="text" id="username" placeholder="Username"><br>
    <input type="password" id="pin" placeholder="4-digit PIN" maxlength="4"><br>
    <button onclick="login()">Login / Create Account</button>
    <p id="login-status"></p>
  </div>  <div class="card hidden" id="dashboard">
    <h2>Welcome, <span id="display-user"></span></h2>
    <p><strong>Wallet ID:</strong> <span id="wallet-id"></span></p>
    <p><strong>Balance:</strong> <span id="wallet-balance">0</span> GLBC</p><h3>Buy Mining Plan</h3>
<button onclick="buyPlan('Basic', 500)">Basic - ₹500</button>
<button onclick="buyPlan('Pro', 1500)">Pro - ₹1500</button>
<button onclick="buyPlan('Ultra', 6500)">Ultra - ₹6500</button>

<div id="qr-section" class="hidden">
  <h4>Pay ₹<span id="amount-pay"></span> to this UPI</h4>
  <p>UPI: 7604909512@fam</p>
  <img src="https://api.qrserver.com/v1/create-qr-code/?data=upi://pay?pa=7604909512@fam&pn=GlobalCoin&cu=INR" width="200" />
  <p>After payment, click below:</p>
  <button onclick="confirmPayment()">I Paid</button>
</div>

<h3>Send GLBC</h3>
<input type="text" id="send-to" placeholder="Recipient Username">
<input type="number" id="send-amount" placeholder="Amount">
<button onclick="sendCoins()">Send</button>

<h3>Redeem Coins</h3>
<input type="text" id="upi-id" placeholder="Your UPI ID">
<button onclick="redeemCoins()">Redeem 10,000 GLBC</button>

<h3>Transaction History</h3>
<ul id="history-log"></ul>

  </div>  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDT0ptouf5QltcOkRUJZQz3oXUFbL7qHtc",
      authDomain: "globalewalletlogin.firebaseapp.com",
      projectId: "globalewalletlogin",
      storageBucket: "globalewalletlogin.appspot.com",
      messagingSenderId: "439233719660",
      appId: "1:439233719660:web:92deeac42afec3a6911749"
    };
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let currentUser = "";

    async function login() {
      const username = document.getElementById('username').value.trim();
      const pin = document.getElementById('pin').value.trim();
      if (username === '' || pin.length !== 4) return alert('Enter valid username and 4-digit PIN');
      currentUser = username;
      const docRef = db.collection('users').doc(username);
      const doc = await docRef.get();
      if (doc.exists) {
        if (doc.data().pin !== pin) return alert('Incorrect PIN');
        loadDashboard(doc.data());
      } else {
        await docRef.set({ pin: pin, balance: 0, history: [] });
        loadDashboard({ pin: pin, balance: 0, history: [] });
      }
    }

    function loadDashboard(data) {
      document.getElementById('login-screen').classList.add('hidden');
      document.getElementById('dashboard').classList.remove('hidden');
      document.getElementById('display-user').textContent = currentUser;
      document.getElementById('wallet-id').textContent = currentUser;
      document.getElementById('wallet-balance').textContent = data.balance;
      updateHistory(data.history);
    }

    function updateHistory(history) {
      const log = document.getElementById('history-log');
      log.innerHTML = '';
      history.slice().reverse().forEach(entry => {
        const li = document.createElement('li');
        li.textContent = `${entry.type}: ${entry.amount} GLBC (${entry.note || ''})`;
        log.appendChild(li);
      });
    }

    function buyPlan(plan, price) {
      document.getElementById('qr-section').classList.remove('hidden');
      document.getElementById('amount-pay').textContent = price;
    }

    async function confirmPayment() {
      const docRef = db.collection('users').doc(currentUser);
      const doc = await docRef.get();
      let newBal = doc.data().balance + 10000; // Simulated reward for demo
      let hist = doc.data().history || [];
      hist.push({ type: 'Plan Activated', amount: 10000, note: 'Mining Plan' });
      await docRef.update({ balance: newBal, history: hist });
      loadDashboard({ pin: doc.data().pin, balance: newBal, history: hist });
      alert('Plan Activated and Coins Credited!');
    }

    async function sendCoins() {
      const toUser = document.getElementById('send-to').value.trim();
      const amount = parseInt(document.getElementById('send-amount').value);
      if (!toUser || isNaN(amount) || amount <= 0) return alert('Invalid input');
      const senderRef = db.collection('users').doc(currentUser);
      const senderDoc = await senderRef.get();
      if (senderDoc.data().balance < amount) return alert('Insufficient balance');
      const receiverRef = db.collection('users').doc(toUser);
      const receiverDoc = await receiverRef.get();
      if (!receiverDoc.exists) return alert('Recipient not found');
      await senderRef.update({
        balance: senderDoc.data().balance - amount,
        history: [...(senderDoc.data().history || []), { type: 'Sent', amount, note: `To ${toUser}` }]
      });
      await receiverRef.update({
        balance: receiverDoc.data().balance + amount,
        history: [...(receiverDoc.data().history || []), { type: 'Received', amount, note: `From ${currentUser}` }]
      });
      alert('Transfer successful');
      location.reload();
    }

    async function redeemCoins() {
      const upi = document.getElementById('upi-id').value.trim();
      if (!upi.includes('@')) return alert('Enter valid UPI ID');
      const docRef = db.collection('users').doc(currentUser);
      const doc = await docRef.get();
      if (doc.data().balance < 10000) return alert('You need at least 10,000 GLBC to redeem');
      await docRef.update({
        balance: doc.data().balance - 10000,
        history: [...(doc.data().history || []), { type: 'Redeemed', amount: 10000, note: `To ${upi}` }]
      });
      alert('Redeem request sent to admin for UPI payout');
      location.reload();
    }
  </script></body>
</html>
